"use strict";var Event={};Event=Event||{},Event.Widget=Event.Widget||{},Event.Widget.TemplateParser=function(t){function e(){this.init()}var o="http",n="api.helsingborg.se",a="/json/",i=a+"wp/v2/event/",l=o+"://"+n+i;return e.prototype.init=function(){t(".event-api").each(function(e,o){this.storeErrorTemplate(t(o)),this.storeTemplate(t(o)),this.storeModalTemplate(t(o)),this.loadEvent(t(o),l)}.bind(this))},e.prototype.storeTemplate=function(e){e.data("template",t(".template",e).html()),e.find(".template").remove()},e.prototype.storeErrorTemplate=function(e){e.data("error-template",t(".error-template",e).html()),e.find(".error-template").remove()},e.prototype.storeModalTemplate=function(e){e.data("modal-template",t(".modal-template",e).html()),e.find(".modal-template").remove()},e.prototype.loadEvent=function(e,o){t.ajax(o).done(function(o){"undefined"==typeof o.data?(e.data("json-response",o),this.clear(e),t(o).each(function(t,o){var n=e.data("template");n=n.replace("{{event-id}}",o.id),n=n.replace("{{event-title}}",o.title.rendered),e.append(n)}),this.click(e)):(this.clear(e),e.html(e.data("error-template")))}.bind(this)).fail(function(){this.clear(e),e.html(e.data("error-template"))}.bind(this))},e.prototype.loadFeaturedImage=function(e,o){t.ajax(e).done(function(t){}.bind(this)).fail(function(){console.log("Could not load the media id.")}.bind(this))},e.prototype.loadContactPerson=function(e,o){t.ajax(e).done(function(t){}.bind(this)).fail(function(){console.log("Could not load contact person.")}.bind(this))},e.prototype.loadLocation=function(e,o){t.ajax(e).done(function(t){}.bind(this)).fail(function(){console.log("Could not load location details.")}.bind(this))},e.prototype.clear=function(t){jQuery(t).html("")},e.prototype.click=function(e){jQuery("li a",e).on("click",{},function(o){var n=jQuery(o.target).closest("a.modal-event").data("event-id");t.each(e.data("json-response"),function(o,a){if(a.id==n){var i=e.data("modal-template");i=i.replace("{{event-modal-title}}",a.title.rendered),i=i.replace("{{event-modal-content}}",a.content.rendered),i=i.replace("{{event-modal-image}}","");var l="";t.each(a.occasions,function(t,e){console.log(e),l=l+"<li>"+e.start_date+" - "+e.end_date+"</li>"}.bind(this)),i=i.replace("{{event-modal-occations}}",'<div class="box box-panel box-panel-secondary"><h4 class="box-title">Evenemanget intr√§ffar</h4><ul id="modal-occations">'+l+"</ul></div>"),t("#modal-event").remove(),t("body").append(i)}}.bind(this))}.bind(this))},new e}(jQuery);